import{e as J,S as K,U as ie,T as re,y as N,O as V,_ as A,M as B,R as te,P as Pe,B as G,N as $e,J as Qe}from"./QTable.f140ec9e.js";import{u as Me,a as Re,c as De,Q as X,b as ne}from"./QCard.ac3273b9.js";import{Q as ce}from"./QTab.f9856545.js";import{Q as Oe,_ as je}from"./FilterEscrows2.96b32a98.js";import{u as He,v as k,t as w,bP as Ne,w as Ae,av as Be,aw as Ee,x as Fe,y as T,R as Le,K as le,H as Ie,a7 as be,ad as ge,b_ as Ue,bn as Ye,a0 as y,a8 as L,a9 as ue,b$ as de,am as C,a1 as p,a2 as i,a3 as r,a6 as a,ah as We,ab as s,aa as m,af as f,a4 as I,al as E,ar as D,bf as ve,P as Je,ao as Xe,I as Ze}from"./index.88d82a6e.js";import{Q as Ke}from"./QPage.9958d048.js";import{g as O,Q as Z}from"./get_token_imageURL_form_mint.763f838d.js";import{f as he}from"./format_address.20184662.js";const me=["vertical","horizontal"],ee={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},fe={prevent:!0,mouse:!0,mouseAllDir:!0},_e=h=>h>=250?50:Math.ceil(h/5);var Ve=He({name:"QScrollArea",props:{...Me,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(h,{slots:j,emit:F}){const Q=k(!1),$=k(!1),P=k(!1),u={vertical:k(0),horizontal:k(0)},e={vertical:{ref:k(null),position:k(0),size:k(0)},horizontal:{ref:k(null),position:k(0),size:k(0)}},{proxy:q}=Ie(),z=Re(h,q.$q);let x=null,_;const c=k(null),d=w(()=>"q-scrollarea"+(z.value===!0?" q-scrollarea--dark":""));e.vertical.percentage=w(()=>{const l=e.vertical.size.value-u.vertical.value;if(l<=0)return 0;const o=J(e.vertical.position.value/l,0,1);return Math.round(o*1e4)/1e4}),e.vertical.thumbHidden=w(()=>(h.visible===null?P.value:h.visible)!==!0&&Q.value===!1&&$.value===!1||e.vertical.size.value<=u.vertical.value+1),e.vertical.thumbStart=w(()=>e.vertical.percentage.value*(u.vertical.value-e.vertical.thumbSize.value)),e.vertical.thumbSize=w(()=>Math.round(J(u.vertical.value*u.vertical.value/e.vertical.size.value,_e(u.vertical.value),u.vertical.value))),e.vertical.style=w(()=>({...h.thumbStyle,...h.verticalThumbStyle,top:`${e.vertical.thumbStart.value}px`,height:`${e.vertical.thumbSize.value}px`})),e.vertical.thumbClass=w(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(e.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),e.vertical.barClass=w(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(e.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),e.horizontal.percentage=w(()=>{const l=e.horizontal.size.value-u.horizontal.value;if(l<=0)return 0;const o=J(Math.abs(e.horizontal.position.value)/l,0,1);return Math.round(o*1e4)/1e4}),e.horizontal.thumbHidden=w(()=>(h.visible===null?P.value:h.visible)!==!0&&Q.value===!1&&$.value===!1||e.horizontal.size.value<=u.horizontal.value+1),e.horizontal.thumbStart=w(()=>e.horizontal.percentage.value*(u.horizontal.value-e.horizontal.thumbSize.value)),e.horizontal.thumbSize=w(()=>Math.round(J(u.horizontal.value*u.horizontal.value/e.horizontal.size.value,_e(u.horizontal.value),u.horizontal.value))),e.horizontal.style=w(()=>({...h.thumbStyle,...h.horizontalThumbStyle,[q.$q.lang.rtl===!0?"right":"left"]:`${e.horizontal.thumbStart.value}px`,width:`${e.horizontal.thumbSize.value}px`})),e.horizontal.thumbClass=w(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(e.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),e.horizontal.barClass=w(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(e.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const b=w(()=>e.vertical.thumbHidden.value===!0&&e.horizontal.thumbHidden.value===!0?h.contentStyle:h.contentActiveStyle),t=[[re,l=>{ae(l,"vertical")},void 0,{vertical:!0,...fe}]],n=[[re,l=>{ae(l,"horizontal")},void 0,{horizontal:!0,...fe}]];function g(){const l={};return me.forEach(o=>{const v=e[o];l[o+"Position"]=v.position.value,l[o+"Percentage"]=v.percentage.value,l[o+"Size"]=v.size.value,l[o+"ContainerSize"]=u[o].value}),l}const S=Ne(()=>{const l=g();l.ref=q,F("scroll",l)},0);function H(l,o,v){if(me.includes(l)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(l==="vertical"?ie:K)(c.value,o,v)}function ye({height:l,width:o}){let v=!1;u.vertical.value!==l&&(u.vertical.value=l,v=!0),u.horizontal.value!==o&&(u.horizontal.value=o,v=!0),v===!0&&U()}function ze({position:l}){let o=!1;e.vertical.position.value!==l.top&&(e.vertical.position.value=l.top,o=!0),e.horizontal.position.value!==l.left&&(e.horizontal.position.value=l.left,o=!0),o===!0&&U()}function Se({height:l,width:o}){e.horizontal.size.value!==o&&(e.horizontal.size.value=o,U()),e.vertical.size.value!==l&&(e.vertical.size.value=l,U())}function ae(l,o){const v=e[o];if(l.isFirst===!0){if(v.thumbHidden.value===!0)return;_=v.position.value,$.value=!0}else if($.value!==!0)return;l.isFinal===!0&&($.value=!1);const R=ee[o],W=u[o].value,qe=(v.size.value-W)/(W-v.thumbSize.value),Te=l.distance[R.dist],Ce=_+(l.direction===R.dir?1:-1)*Te*qe;se(Ce,o)}function oe(l,o){const v=e[o];if(v.thumbHidden.value!==!0){const R=l[ee[o].offset];if(R<v.thumbStart.value||R>v.thumbStart.value+v.thumbSize.value){const W=R-v.thumbSize.value/2;se(W/u[o].value*v.size.value,o)}v.ref.value!==null&&v.ref.value.dispatchEvent(new MouseEvent(l.type,l))}}function we(l){oe(l,"vertical")}function ke(l){oe(l,"horizontal")}function U(){Q.value=!0,x!==null&&clearTimeout(x),x=setTimeout(()=>{x=null,Q.value=!1},h.delay),h.onScroll!==void 0&&S()}function se(l,o){c.value[ee[o].scroll]=l}let M=null;function xe(){M!==null&&clearTimeout(M),M=setTimeout(()=>{M=null,P.value=!0},q.$q.platform.is.ios?50:0)}function pe(){M!==null&&(clearTimeout(M),M=null),P.value=!1}let Y=null;return Ae(()=>q.$q.lang.rtl,l=>{c.value!==null&&K(c.value,Math.abs(e.horizontal.position.value)*(l===!0?-1:1))}),Be(()=>{Y={top:e.vertical.position.value,left:e.horizontal.position.value}}),Ee(()=>{if(Y===null)return;const l=c.value;l!==null&&(K(l,Y.left),ie(l,Y.top))}),Fe(S.cancel),Object.assign(q,{getScrollTarget:()=>c.value,getScroll:g,getScrollPosition:()=>({top:e.vertical.position.value,left:e.horizontal.position.value}),getScrollPercentage:()=>({top:e.vertical.percentage.value,left:e.horizontal.percentage.value}),setScrollPosition:H,setScrollPercentage(l,o,v){H(l,o*(e[l].size.value-u[l].value)*(l==="horizontal"&&q.$q.lang.rtl===!0?-1:1),v)}}),()=>T("div",{class:d.value,onMouseenter:xe,onMouseleave:pe},[T("div",{ref:c,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:h.tabindex!==void 0?h.tabindex:void 0},[T("div",{class:"q-scrollarea__content absolute",style:b.value},Le(j.default,[T(ce,{debounce:0,onResize:Se})])),T(Oe,{axis:"both",onScroll:ze})]),T(ce,{debounce:0,onResize:ye}),T("div",{class:e.vertical.barClass.value,style:[h.barStyle,h.verticalBarStyle],"aria-hidden":"true",onMousedown:we}),T("div",{class:e.horizontal.barClass.value,style:[h.barStyle,h.horizontalBarStyle],"aria-hidden":"true",onMousedown:ke}),le(T("div",{ref:e.vertical.ref,class:e.vertical.thumbClass.value,style:e.vertical.style.value,"aria-hidden":"true"}),t),le(T("div",{ref:e.horizontal.ref,class:e.horizontal.thumbClass.value,style:e.horizontal.style.value,"aria-hidden":"true"}),n)])}});const Ge={key:0,class:"q-gutter-y-xs"},et={class:"row items-center"},tt={style:{width:"100px"},class:"row items-center q-gutter-x-sm"},lt={class:"text-white"},at={class:"col q-gutter-y-xs"},ot={class:"text-white"},st={class:"row items-center q-gutter-x-sm"},it={class:"text-h6 text-weight-thin text-right",style:{width:"150px"}},rt={class:"text-h5 text-weight-light",style:{width:"200px"}},nt={key:0,class:"col justify-end row q-gutter-x-xs items-center"},ct=a("div",{style:{"font-size":"10px"}},"best price",-1),ut={class:"text-subtitle1 text-right",style:{width:"100px"}},dt={class:"row items-center"},vt={class:"row items-center"},ht={style:{width:"70px"},class:"q-gutter-y-xs"},mt={class:"text-white"},ft={style:{width:"70px"},class:"q-gutter-y-xs"},_t={class:"text-white"},bt={class:"row items-center justify-evenly"},gt={class:"row items-center q-gutter-x-sm"},yt={class:"text-h6 text-weight-thin text-right",style:{width:"150px"}},zt={class:"text-h6 text-weight-light",style:{width:"200px"}},St={class:"row items-center q-gutter-x-sm"},wt={class:"text-h6 text-weight-thin text-right",style:{width:"150px"}},kt={class:"text-h6 text-weight-light",style:{width:"200px"}},xt={class:"row items-center"},pt={class:"col q-gutter-y-sm"},qt={class:"row items-center q-gutter-x-xs justify-end"},Tt={class:"row items-center q-gutter-x-xs justify-end"},Ct={class:"row items-center",style:{width:"100px"}},Pt={class:"col"},$t={class:"col"},Qt={class:"col"},Mt={class:"col"},Rt={class:"col"},Dt={key:1,class:"col text-center"},Ot=a("h5",null,"No Escrows found",-1),jt=a("h6",null,"You may need to check your filter settings",-1),Ht=[Ot,jt],Nt=be({__name:"EscrowCards",setup(h){k("buy_name");const j=k(ge().screen.lt.md),F=Ue().path;function Q(z,x){return z?z==null?void 0:z.reduce((c,d)=>{const{depositToken:b,requestToken:t}=d.account,n=f().token_list.find(H=>H.address==b.toString()),g=f().token_list.find(H=>H.address==t.toString());let S;return x=="buy"?S=`${n==null?void 0:n.symbol}`:x=="sell"?S=`${g==null?void 0:g.symbol}`:x=="3"&&(S=`${n==null?void 0:n.symbol}-${g==null?void 0:g.symbol}`),c[S]||(c[S]=[]),c[S].push(d),c},{}):void 0}const $=Ye();function P(z){if(j.value)$.push(`/details/${z.publicKey.toString()}`);else{if(C().escrow_selected==z){f().showRightDrawer=!1,C().escrow_selected=void 0;return}C().escrow_selected=z,F.includes("exchange")&&(f().showRightDrawer=!0)}}function u(z,x,_){var b;let c=new Je(((b=f().token_list.find(t=>t.symbol==x))==null?void 0:b.address)??""),d=z.flatMap(t=>{var n,g;return t.account.depositToken==c?_=="buy"?t.account.tokensDepositRemaining.toNumber():1/t.account.tokensDepositRemaining.toNumber():_=="sell"?t.account.price*t.account.tokensDepositRemaining*10**-((n=f().token_list.find(S=>S.address==t.account.depositToken.toString()))==null?void 0:n.decimals):t.account.tokensDepositRemaining*10**-((g=f().token_list.find(S=>S.address==t.account.depositToken.toString()))==null?void 0:g.decimals)}).reduce((t,n)=>t+n,0);return B(d,0)}function e(z,x){if(z.length!=0)return console.log(x),console.log(z),z.map(_=>[_.account.price,1/_.account.price])}const q=w(()=>C().escrows_cards);return(z,x)=>Object.entries(q.value).every(([_,c])=>c.length==0)?(y(),L("div",Dt,Ht)):(y(),L("div",Ge,[(y(!0),L(ue,null,de(Object.entries(q.value).filter(([_,c])=>c.length>0),([_,c])=>(y(),p(X,{square:"",flat:"",key:_},{default:i(()=>[r(te,null,{header:i(()=>[r(N,{avatar:""},{default:i(()=>[a("div",et,[r(V,{color:"transparent",outline:"",class:We(["col text-center q-ma-sm",`bg-${s(C)().filter_cards.by}`])},{default:i(()=>{var d;return[a("div",tt,[a("div",lt,m(s(C)().filter_cards.by.toUpperCase()),1),r(De,{vertical:""}),a("div",at,[r(A,{class:"",size:"sm",src:s(O)((d=s(f)().token_list.find(b=>b.symbol==_))==null?void 0:d.address)},null,8,["src"]),a("div",ot,m(_),1)])])]}),_:2},1032,["class"])])]),_:2},1024),r(N,null,{default:i(()=>[a("div",st,[a("div",it,m(u(c,_,s(C)().filter_cards.by)),1),a("div",rt,m(s(f)().token_list.find(d=>d.symbol==_).name),1),(s(C)().filter_cards.by==="buy"?c.every(d=>d.account.requestToken.toString()===c[0].account.requestToken.toString()):c.every(d=>d.account.depositToken.toString()===c[0].account.depositToken.toString()))?(y(),L("div",nt,[ct,a("div",ut,m(s(B)(Math.min(...e(c,_).map(d=>d[s(C)().filter_cards.by=="buy"?0:1])),5)),1),r(A,{size:"xs",src:s(C)().filter_cards.by=="buy"?s(O)(c[0].account.requestToken.toString()):s(O)(c[0].account.depositToken.toString())},null,8,["src"]),I(" "+m(),1)])):E("",!0)])]),_:2},1024),r(N,{side:""},{default:i(()=>[a("div",dt,[r(D,{name:"tag"}),a("div",null,m(c.length),1)])]),_:2},1024)]),default:i(()=>[le((y(),p(X,null,{default:i(()=>[c?(y(),p(ne,{key:0},{default:i(()=>[(y(!0),L(ue,null,de(Object.entries(Q(c,"3")),([d,b])=>(y(),p(X,{class:"q-mb-sm",bordered:"",square:"",flat:"",key:d},{default:i(()=>[r(te,{"default-opened":""},{header:i(()=>[r(N,{avatar:""},{default:i(()=>[a("div",vt,[r(V,{color:"transparent",outline:"",class:"col text-center q-ma-sm bg-sell"},{default:i(()=>[a("div",ht,[r(A,{class:"",size:"sm",src:s(O)(b[0].account.requestToken.toString())},null,8,["src"]),a("div",mt,m(s(f)().token_list.find(t=>t.address==b[0].account.requestToken.toString()).symbol),1)])]),_:2},1024),r(D,{size:"md",name:"chevron_right"}),r(V,{color:"transparent",outline:"",class:"col text-center q-ma-sm bg-buy"},{default:i(()=>[a("div",ft,[r(A,{class:"",size:"sm",src:s(O)(b[0].account.depositToken.toString())},null,8,["src"]),a("div",_t,m(s(f)().token_list.find(t=>t.address==b[0].account.depositToken.toString()).symbol),1)])]),_:2},1024)])]),_:2},1024),j.value?E("",!0):(y(),p(N,{key:0},{default:i(()=>[a("div",bt,[a("div",gt,[a("div",yt,m(u(b,d.split("-")[1],"sell")),1),a("div",zt,m(s(f)().token_list.find(t=>t.symbol==d.split("-")[1]).name),1)]),r(D,{size:"md",name:"chevron_right"}),a("div",St,[a("div",wt,m(u(b,d.split("-")[0],"buy")),1),a("div",kt,m(s(f)().token_list.find(t=>t.symbol==d.split("-")[0]).name),1)])])]),_:2},1024)),r(N,{side:""},{default:i(()=>[a("div",xt,[r(D,{name:"tag"}),a("div",null,m(b.length),1)])]),_:2},1024)]),default:i(()=>[r(X,null,{default:i(()=>[b?(y(),p(ne,{key:0},{default:i(()=>[r(Pe,{flat:"","hide-bottom":"","rows-per-page-options":[0],rows:b,columns:[{name:"options",align:"left",label:"Options",field:"account",sortable:!0},{name:"escrow",label:"Escrow",align:"left",field:"publicKey",format:(t,n)=>s(he)(`${t}`),sortable:!0},{name:"maker",align:"left",label:"Maker",field:"account",format:(t,n)=>s(he)(`${t.maker}`),sortable:!0},{name:"volume",label:"Size",field:"account",format:(t,n)=>`${t}`,sortable:!0},{name:"price",label:"Price per Unit",field:"account",format:(t,n)=>`${t.price.toString()}`,sortable:!0}]},{"body-cell":i(t=>[t.col.name=="price"?(y(),p(Z,{key:0,props:t,onClick:n=>P(t.row)},{default:i(()=>{var n,g;return[a("div",pt,[a("div",qt,[a("div",null,m(s(B)(parseFloat(t.value),5)),1),r(A,{class:"",size:"xs",src:s(O)((n=s(f)().token_list.find(S=>S.symbol==d.split("-")[1]))==null?void 0:n.address)},null,8,["src"])]),a("div",Tt,[a("div",null,m(s(B)(1/parseFloat(t.value),5)),1),r(A,{class:"",size:"xs",src:s(O)((g=s(f)().token_list.find(S=>S.symbol==d.split("-")[0]))==null?void 0:g.address)},null,8,["src"])])])]}),_:2},1032,["props","onClick"])):t.col.name=="options"?(y(),p(Z,{key:1,onClick:n=>P(t.row),props:t},{default:i(()=>{var n;return[a("div",Ct,[a("div",Pt,[r(D,{size:"sm",name:"balance",color:t.row.account.allowPartialFill?"purple":"grey"},{default:i(()=>[r(G,null,{default:i(()=>[I("Partial fill "+m(t.row.account.allowPartialFill?"":"NOT ")+" allowed",1)]),_:2},1024)]),_:2},1032,["color"])]),a("div",$t,[r(D,{size:"sm",name:"timer",color:t.row.account.expireTimestamp>0?"orange":"grey"},{default:i(()=>[r(G,null,{default:i(()=>[I("Will "+m(t.row.account.expireTimestamp>0?"":"NOT ")+" expire",1)]),_:2},1024)]),_:2},1032,["color"])]),a("div",Qt,[r(D,{size:"sm",name:"design_services",color:t.row.account.maker.toString()==((n=s(ve)().publicKey.value)==null?void 0:n.toString())?"orange":"grey"},{default:i(()=>[r(G,null,{default:i(()=>{var g;return[I("You are "+m(t.row.account.maker.toString()===((g=s(ve)().publicKey.value)==null?void 0:g.toString())?"":"NOT ")+" the creator",1)]}),_:2},1024)]),_:2},1032,["color"])]),a("div",Mt,[r($e,{size:"xs",escrow:t.row},null,8,["escrow"])])])]}),_:2},1032,["onClick","props"])):t.col.name=="volume"?(y(),p(Z,{key:2,onClick:n=>P(t.row),props:t},{default:i(()=>[a("div",Rt,[a("div",null,m(s(B)(t.row.account.price*t.row.account.tokensDepositRemaining*10**-s(f)().token_list.find(n=>n.address==t.row.account.depositToken).decimals,1)),1),a("div",null,m(s(B)(t.row.account.tokensDepositRemaining*10**-s(f)().token_list.find(n=>n.address==t.row.account.depositToken).decimals,1)),1)])]),_:2},1032,["onClick","props"])):(y(),p(Z,{key:3,props:t,onClick:n=>P(t.row)},{default:i(()=>[I(m(t.value),1)]),_:2},1032,["props","onClick"]))]),_:2},1032,["rows","columns"])]),_:2},1024)):E("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)):E("",!0)]),_:2},1024)),[[Xe]])]),_:2},1024)]),_:2},1024))),128))]))}});const Wt=be({__name:"ExchangePage2",setup(h){Ze(()=>{f().showLeftDrawer=!0,f().showRightDrawer=!1});const j=k({right:"2px",borderRadius:"9px",backgroundColor:"none",width:"8px",opacity:.2}),F=k({right:"0px",borderRadius:"0px",backgroundColor:"#888",width:"5px",opacity:1});return(Q,$)=>(y(),p(Ke,{class:"row"},{default:i(()=>[r(Ve,{"thumb-style":F.value,"bar-style":j.value,visible:"",class:"col"},{default:i(()=>[s(ge)().screen.lt.md?(y(),p(Qe,{key:0,bordered:"",class:"bg-dark"},{default:i(()=>[r(te,{"expand-separator":"",icon:"search",label:"Filters"},{default:i(()=>[r(je)]),_:1})]),_:1})):E("",!0),s(f)().is_init?(y(),p(Nt,{key:1})):E("",!0)]),_:1},8,["thumb-style","bar-style"])]),_:1}))}});export{Wt as default};
